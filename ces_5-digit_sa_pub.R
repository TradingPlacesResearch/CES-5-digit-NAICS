# Initialize blscrapeR. You will need to install blscrape and get a bls api key
# blscrape: https://github.com/keberwein/blscrapeR
# API: https://data.bls.gov/registrationEngine/

library(blscrapeR)
set_bls_key("YOUR_API_KEY_BETWEEN_THE_QUOTES")
setwd("YOUR_WORKING_DIR_BETWEEN_THE_QUOTES")

# Put your start and end years in these constants

start_year <- 2018
end_year <- 2021


df01 <- bls_api(c("CES0000000001", "CES0500000001", "CES0600000001", "CES0700000001", "CES0800000001", "CES1000000001", "CES1011330001", "CES1021000001", "CES1021100001", "CES1021200001", "CES1021210001", "CES1021220001", "CES1021230001", "CES1021300001", "CES2000000001", "CES2023600001", "CES2023610001", "CES2023620001", "CES2023700001", "CES2023710001", "CES2023720001", "CES2023730001", "CES2023790001", "CES2023800001", "CES2023800101"), startyear = start_year, endyear = end_year, Sys.getenv("BLS_KEY")) %>%
  dateCast()

df02 <- bls_api(c("CES2023800201", "CES2023810001", "CES2023810101", "CES2023810201", "CES2023820001", "CES2023820101", "CES2023820201", "CES2023830001", "CES2023830101", "CES2023830201", "CES2023890001", "CES2023890101", "CES2023890201", "CES3000000001", "CES3100000001", "CES3132100001", "CES3132110001", "CES3132120001", "CES3132190001", "CES3132700001", "CES3132710001", "CES3132720001", "CES3132730001", "CES3132790001", "CES3133100001"), startyear = start_year, endyear = end_year, Sys.getenv("BLS_KEY")) %>%
  dateCast()

df03 <- bls_api(c("CES3133110001", "CES3133120001", "CES3133130001", "CES3133140001", "CES3133150001", "CES3133200001", "CES3133210001", "CES3133220001", "CES3133230001", "CES3133240001", "CES3133260001", "CES3133270001", "CES3133280001", "CES3133290001", "CES3133300001", "CES3133310001", "CES3133320001", "CES3133330001", "CES3133340001", "CES3133350001", "CES3133360001", "CES3133390001", "CES3133400001", "CES3133410001", "CES3133420001"), startyear = start_year, endyear = end_year, Sys.getenv("BLS_KEY")) %>%
  dateCast()

df04 <- bls_api(c("CES3133440001", "CES3133450001", "CES3133460001", "CES3133500001", "CES3133510001", "CES3133520001", "CES3133530001", "CES3133590001", "CES3133600001", "CES3133600101", "CES3133610001", "CES3133620001", "CES3133630001", "CES3133640001", "CES3133660001", "CES3133690001", "CES3133700001", "CES3133710001", "CES3133720001", "CES3133790001", "CES3133900001", "CES3133910001", "CES3133990001", "CES3200000001", "CES3231100001"), startyear = start_year, endyear = end_year, Sys.getenv("BLS_KEY")) %>%
  dateCast()

df05 <- bls_api(c("CES3231110001", "CES3231120001", "CES3231130001", "CES3231140001", "CES3231150001", "CES3231160001", "CES3231170001", "CES3231180001", "CES3231190001", "CES3231300001", "CES3231320001", "CES3231400001", "CES3231410001", "CES3231490001", "CES3231500001", "CES3231520001", "CES3231590001", "CES3232200001", "CES3232210001", "CES3232220001", "CES3232300001", "CES3232400001", "CES3232500001", "CES3232510001", "CES3232520001"), startyear = start_year, endyear = end_year, Sys.getenv("BLS_KEY")) %>%
  dateCast()

df06 <- bls_api(c("CES3232530001", "CES3232540001", "CES3232550001", "CES3232560001", "CES3232590001", "CES3232600001", "CES3232610001", "CES3232620001", "CES3232900001", "CES3232910001", "CES3232990001", "CES4000000001", "CES4142000001", "CES4142300001", "CES4142310001", "CES4142320001", "CES4142330001", "CES4142340001", "CES4142350001", "CES4142360001", "CES4142370001", "CES4142380001", "CES4142390001", "CES4142400001", "CES4142410001"), startyear = start_year, endyear = end_year, Sys.getenv("BLS_KEY")) %>%
  dateCast()

df07 <- bls_api(c("CES4142420001", "CES4142430001", "CES4142440001", "CES4142450001", "CES4142460001", "CES4142470001", "CES4142480001", "CES4142490001", "CES4142500001", "CES4200000001", "CES4244100001", "CES4244110001", "CES4244120001", "CES4244130001", "CES4244200001", "CES4244210001", "CES4244220001", "CES4244300001", "CES4244400001", "CES4244410001", "CES4244420001", "CES4244500001", "CES4244510001", "CES4244520001", "CES4244530001"), startyear = start_year, endyear = end_year, Sys.getenv("BLS_KEY")) %>%
  dateCast()

df08 <- bls_api(c("CES4244600001", "CES4244700001", "CES4244800001", "CES4244810001", "CES4244820001", "CES4244830001", "CES4245100001", "CES4245110001", "CES4245120001", "CES4245200001", "CES4245220001", "CES4245230001", "CES4245300001", "CES4245310001", "CES4245320001", "CES4245330001", "CES4245390001", "CES4245400001", "CES4245410001", "CES4245420001", "CES4245430001", "CES4300000001", "CES4348100001", "CES4348110001", "CES4348120001"), startyear = start_year, endyear = end_year, Sys.getenv("BLS_KEY")) %>%
  dateCast()

df09 <- bls_api(c("CES4348200001", "CES4348300001", "CES4348400001", "CES4348410001", "CES4348420001", "CES4348500001", "CES4348530001", "CES4348540001", "CES4348550001", "CES4348590001", "CES4348600001", "CES4348700001", "CES4348800001", "CES4348810001", "CES4348830001", "CES4348840001", "CES4348850001", "CES4348890001", "CES4349200001", "CES4349210001", "CES4349300001", "CES4422000001", "CES4422110001", "CES4422120001", "CES4422130001"), startyear = start_year, endyear = end_year, Sys.getenv("BLS_KEY")) %>%
  dateCast()

df10 <- bls_api(c("CES5000000001", "CES5051100001", "CES5051110001", "CES5051120001", "CES5051200001", "CES5051500001", "CES5051510001", "CES5051520001", "CES5051700001", "CES5051730001", "CES5051790001", "CES5051800001", "CES5051900001", "CES5500000001", "CES5552000001", "CES5552100001", "CES5552200001", "CES5552210001", "CES5552220001", "CES5552230001", "CES5552300001", "CES5552320001", "CES5552390001", "CES5552400001", "CES5552410001"), startyear = start_year, endyear = end_year, Sys.getenv("BLS_KEY")) %>%
  dateCast()

df11 <- bls_api(c("CES5552420001", "CES5553000001", "CES5553100001", "CES5553110001", "CES5553120001", "CES5553130001", "CES5553200001", "CES5553210001", "CES5553220001", "CES5553230001", "CES5553240001", "CES5553300001", "CES6000000001", "CES6054000001", "CES6054110001", "CES6054120001", "CES6054130001", "CES6054140001", "CES6054150001", "CES6054160001", "CES6054170001", "CES6054180001", "CES6054190001", "CES6055000001", "CES6056000001"), startyear = start_year, endyear = end_year, Sys.getenv("BLS_KEY")) %>%
  dateCast()

df12 <- bls_api(c("CES6056100001", "CES6056110001", "CES6056120001", "CES6056130001", "CES6056140001", "CES6056150001", "CES6056160001", "CES6056170001", "CES6056190001", "CES6056200001", "CES6056210001", "CES6056220001", "CES6056290001", "CES6500000001", "CES6561000001", "CES6561110001", "CES6561120001", "CES6561130001", "CES6561140001", "CES6561150001", "CES6561160001", "CES6561170001", "CES6562000001", "CES6562000101", "CES6562100001"), startyear = start_year, endyear = end_year, Sys.getenv("BLS_KEY")) %>%
  dateCast()

df13 <- bls_api(c("CES6562110001", "CES6562120001", "CES6562130001", "CES6562140001", "CES6562150001", "CES6562160001", "CES6562190001", "CES6562200001", "CES6562210001", "CES6562220001", "CES6562230001", "CES6562300001", "CES6562310001", "CES6562320001", "CES6562330001", "CES6562390001", "CES6562400001", "CES6562410001", "CES6562420001", "CES6562430001", "CES6562440001", "CES7000000001", "CES7071000001", "CES7071100001", "CES7071110001"), startyear = start_year, endyear = end_year, Sys.getenv("BLS_KEY")) %>%
  dateCast()

df14 <- bls_api(c("CES7071120001", "CES7071130001", "CES7071150001", "CES7071200001", "CES7071300001", "CES7071310001", "CES7071320001", "CES7071390001", "CES7072000001", "CES7072100001", "CES7072110001", "CES7072120001", "CES7072200001", "CES7072230001", "CES7072240001", "CES7072250001", "CES8000000001", "CES8081100001", "CES8081110001", "CES8081120001", "CES8081130001", "CES8081140001", "CES8081200001", "CES8081210001", "CES8081220001"), startyear = start_year, endyear = end_year, Sys.getenv("BLS_KEY")) %>%
  dateCast()

df15 <- bls_api(c("CES8081230001", "CES8081290001", "CES8081300001", "CES8081320001", "CES8081330001", "CES8081340001", "CES8081390001", "CES9000000001", "CES9091000001", "CES9091100001", "CES9091622001", "CES9091911001", "CES9091912001", "CES9091999901", "CES9092000001", "CES9092161101", "CES9092200001", "CES9092262201", "CES9092292001", "CES9092299901", "CES9093000001", "CES9093161101", "CES9093200001", "CES9093222101", "CES9093248001"), startyear = start_year, endyear = end_year, Sys.getenv("BLS_KEY")) %>%
  dateCast()

df16 <- bls_api(c("CES9093262201", "CES9093292001", "CES9093299901"), startyear = start_year, endyear = end_year, Sys.getenv("BLS_KEY")) %>%
  dateCast()

# Merge and write CSV

ces_5dig <- do.call("rbind", list(df01, df02, df03, df04, df05, df06, df07, df08, df09, df10, df11, df12, df13, df14, df15, df16))

write.csv(ces_5dig, "ces_5dig.csv")